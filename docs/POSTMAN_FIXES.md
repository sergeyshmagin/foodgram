# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –∏–∑ Postman —Ç–µ—Å—Ç–æ–≤

–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ API —á–µ—Ä–µ–∑ Postman –∫–æ–ª–ª–µ–∫—Ü–∏—é.

## üö® –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. 500 Internal Server Error –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ä–µ—Ü–µ–ø—Ç–∞ —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–º

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ–±–Ω–æ–≤–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç —Å ID –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ 500.

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
```json
{
    "ingredients": [
        {
            "id": 99999,
            "amount": 20
        }
    ],
    "tags": [4],
    "image": "data:image/png;base64,...",
    "name": "–†–µ—Ü–µ–ø—Ç —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–º",
    "text": "–û–ø–∏—Å–∞–Ω–∏–µ",
    "cooking_time": 12
}
```

**–û—à–∏–±–∫–∞**: 
```html
<!doctype html>
<html lang="en">
<head>
    <title>Server Error (500)</title>
</head>
<body>
    <h1>Server Error (500)</h1>
</body>
</html>
```

### 2. 401 Unauthorized –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –ø—Ä–æ—Ñ–∏–ª—è –±–µ–∑ —Ç–æ–∫–µ–Ω–∞

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—à–∏–±–∫–∞, –Ω–æ –Ω—É–∂–Ω–æ –±—ã–ª–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è.

**–û—à–∏–±–∫–∞**:
```json
{
    "detail": "–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –±—ã–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã."
}
```

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –≤ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–µ

**–§–∞–π–ª**: `backend/apps/api/serializers.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤ –º–µ—Ç–æ–¥–µ `validate_ingredients()`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –º–µ—Ç–æ–¥–µ `_create_ingredients()` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è 500 –æ—à–∏–±–æ–∫

**–ö–æ–¥**:
```python
def validate_ingredients(self, value):
    """–í–∞–ª–∏–¥–∞—Ü–∏—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤."""
    if not value:
        raise serializers.ValidationError(
            "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç."
        )

    ingredient_ids = []
    for ingredient_data in value:
        ingredient_id = ingredient_data.get("id")
        amount = ingredient_data.get("amount")

        if not ingredient_id:
            raise serializers.ValidationError("ID –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.")

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
        if not Ingredient.objects.filter(id=ingredient_id).exists():
            raise serializers.ValidationError(
                f"–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç —Å ID {ingredient_id} –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç."
            )

        # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω—ã comprehensive —Ç–µ—Å—Ç—ã

**–§–∞–π–ª**: `backend/tests/test_api_serializers.py`

**–ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã**:
- `test_recipe_creation_nonexistent_ingredient` - —Ç–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ—Ü–µ–ø—Ç–∞ —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–º
- `test_recipe_update_nonexistent_ingredient` - —Ç–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ—Ü–µ–ø—Ç–∞ —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–º
- `test_recipe_creation_invalid_ingredient_amount` - —Ç–µ—Å—Ç —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞
- `test_recipe_creation_duplicate_ingredients` - —Ç–µ—Å—Ç —Å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–º–∏—Å—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞–º–∏
- `test_recipe_creation_duplicate_tags` - —Ç–µ—Å—Ç —Å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–º–∏—Å—è —Ç–µ–≥–∞–º–∏
- `test_recipe_creation_string_amount` - —Ç–µ—Å—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏

### 3. –£–ª—É—á—à–µ–Ω—ã —Ñ–∏–∫—Å—Ç—É—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤

**–§–∞–π–ª**: `backend/tests/conftest.py`

**–î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ–∏–∫—Å—Ç—É—Ä—ã**:
- `subscription` - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–æ–∫
- `ingredient_in_recipe` - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤—è–∑–µ–π –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ —Å —Ä–µ—Ü–µ–ø—Ç–∞–º–∏

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –¢–µ–ø–µ—Ä—å API –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:

#### ‚ùå –í–º–µ—Å—Ç–æ 500 Internal Server Error:
```json
{
    "ingredients": [
        "–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç —Å ID 99999 –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç."
    ]
}
```
**Status Code**: 400 Bad Request

#### ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –∏ —Ç–µ–≥–æ–≤
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
cd backend && python -m pytest tests/ -v

# –¢–µ—Å—Ç—ã —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤
python -m pytest tests/test_api_serializers.py -v

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏
python -m pytest tests/test_api_serializers.py::TestRecipeCreateUpdateSerializer::test_recipe_creation_nonexistent_ingredient -v
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤:
- ‚úÖ **143 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ**
- ‚úÖ **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è**
- ‚úÖ **–í—Å–µ pre-commit hooks –ø—Ä–æ—Ö–æ–¥—è—Ç**

## üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Postman

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä** —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
2. **–ü–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å Postman –∫–æ–ª–ª–µ–∫—Ü–∏—é**
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ**:
   - –û—à–∏–±–∫–∏ 500 –±–æ–ª—å—à–µ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞—é—Ç
   - API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (400 Bad Request)
   - –í—Å–µ –≤–∞–ª–∏–¥–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:
1. **–í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é** —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
2. **–ü–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã** –¥–ª—è edge cases –∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ValidationError** –≤–º–µ—Å—Ç–æ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ API** —á–µ—Ä–µ–∑ Postman –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
1. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –Ω–∞—Ä–∞–≤–Ω–µ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏
2. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏** (–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ ID, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö)
3. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥–æ–≤**
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–æ–≤ –æ–± –æ—à–∏–±–∫–∞—Ö**

---

**‚úÖ –°—Ç–∞—Ç—É—Å**: –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. 