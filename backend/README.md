# Foodgram Backend API

–ë—ç–∫–µ–Ω–¥ –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Foodgram - –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ä–µ—Ü–µ–ø—Ç–æ–≤.

## ‚úÖ –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –≠—Ç–∞–ø 1-3: –û—Å–Ω–æ–≤–∞ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Django —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ `users`, `recipes`, `api`
- ‚úÖ –ú–æ–¥–µ–ª–∏: User, Recipe, Ingredient, Tag, Favorite, ShoppingCart, Subscription  
- ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ (2186 –∑–∞–ø–∏—Å–µ–π)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∞–¥–º–∏–Ω–∫–∞ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
- ‚úÖ –°–æ–∑–¥–∞–Ω —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `admin@foodgram.ru` / `admin123`

### –≠—Ç–∞–ø 4: REST API ‚úÖ –ó–ê–í–ï–†–®–Å–ù
–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π REST API —Å–æ–≥–ª–∞—Å–Ω–æ **OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏** (`docs/openapi-schema.yml`):

#### üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ `/api/users/`
- `GET /api/users/` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
- `POST /api/users/` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /api/users/{id}/` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID
- `GET /api/users/me/` - —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `PUT /api/users/me/avatar/` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞ (base64)
- `DELETE /api/users/me/avatar/` - —É–¥–∞–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞
- `POST /api/users/set_password/` - —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è

#### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è `/api/auth/`
- `POST /api/auth/token/login/` - –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –ø–æ email/password
- `POST /api/auth/token/logout/` - —É–¥–∞–ª–∏—Ç—å —Ç–æ–∫–µ–Ω

#### üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –ü–æ–¥–ø–∏—Å–∫–∏ `/api/users/`
- `GET /api/users/subscriptions/` - –º–æ–∏ –ø–æ–¥–ø–∏—Å–∫–∏ (—Å —Ä–µ—Ü–µ–ø—Ç–∞–º–∏)
- `POST /api/users/{id}/subscribe/` - –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `DELETE /api/users/{id}/subscribe/` - –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### üè∑Ô∏è –¢–µ–≥–∏ `/api/tags/`
- `GET /api/tags/` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–µ–≥–æ–≤ (–±–µ–∑ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏)
- `GET /api/tags/{id}/` - –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–≥ –ø–æ ID

#### ü•ï –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã `/api/ingredients/`
- `GET /api/ingredients/` - —Å–ø–∏—Å–æ–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ (–±–µ–∑ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏)
- `GET /api/ingredients/?name=–º—É–∫–∞` - –ø–æ–∏—Å–∫ –ø–æ –Ω–∞—á–∞–ª—É –Ω–∞–∑–≤–∞–Ω–∏—è
- `GET /api/ingredients/{id}/` - –ø–æ–ª—É—á–∏—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç –ø–æ ID

#### üç≥ –†–µ—Ü–µ–ø—Ç—ã `/api/recipes/`
- `GET /api/recipes/` - —Å–ø–∏—Å–æ–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä—ã)
- `POST /api/recipes/` - —Å–æ–∑–¥–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç (—Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ)
- `GET /api/recipes/{id}/` - –ø–æ–ª—É—á–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç –ø–æ ID
- `PATCH /api/recipes/{id}/` - –æ–±–Ω–æ–≤–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç (—Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä)
- `DELETE /api/recipes/{id}/` - —É–¥–∞–ª–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç (—Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä)
- `GET /api/recipes/{id}/get-link/` - –∫–æ—Ä–æ—Ç–∫–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ—Ü–µ–ø—Ç

##### –§–∏–ª—å—Ç—Ä—ã –¥–ª—è —Ä–µ—Ü–µ–ø—Ç–æ–≤:
- `?is_favorited=1` - —Ç–æ–ª—å–∫–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã
- `?is_in_shopping_cart=1` - —Ç–æ–ª—å–∫–æ —Ä–µ—Ü–µ–ø—Ç—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ
- `?author={user_id}` - —Ä–µ—Ü–µ–ø—Ç—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞  
- `?tags=breakfast&tags=lunch` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥–∞–º (slug)

#### ‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ `/api/recipes/{id}/favorite/`
- `POST /api/recipes/{id}/favorite/` - –¥–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- `DELETE /api/recipes/{id}/favorite/` - —É–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ

#### üõí –°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ `/api/recipes/{id}/shopping_cart/`
- `POST /api/recipes/{id}/shopping_cart/` - –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫
- `DELETE /api/recipes/{id}/shopping_cart/` - —É–¥–∞–ª–∏—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–∫—É–ø–æ–∫
- `GET /api/recipes/download_shopping_cart/` - —Å–∫–∞—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ (TXT)

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Token Authentication** - –≤—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ endpoints —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫:
  ```
  Authorization: Token YOUR_TOKEN_HERE
  ```

### –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **base64** —Ñ–æ—Ä–º–∞—Ç–∞ –¥–ª—è —Ä–µ—Ü–µ–ø—Ç–æ–≤ –∏ –∞–≤–∞—Ç–∞—Ä–æ–≤:
  ```json
  {
    "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAB..."
  }
  ```

### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- **–ü—É–±–ª–∏—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ**: —Ç–µ–≥–∏, –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã, —Ä–µ—Ü–µ–ø—Ç—ã, –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è**: —Å–æ–∑–¥–∞–Ω–∏–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–æ–≤, –∏–∑–±—Ä–∞–Ω–Ω–æ–µ, –∫–æ—Ä–∑–∏–Ω–∞, –ø–æ–¥–ø–∏—Å–∫–∏
- **–¢–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Å–≤–æ–∏—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- `select_related()` –∏ `prefetch_related()` –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è N+1 queries
- –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –∏ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (PostgreSQL, Redis, MinIO)
docker-compose -f docker-compose.dev.yml up -d

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv/Scripts/activate     # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ú–∏–≥—Ä–∞—Ü–∏–∏
python manage.py migrate

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
python manage.py loaddata fixtures/ingredients.json
python manage.py create_test_data
python manage.py create_admin

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
python manage.py runserver
```

### API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
- **API Base URL**: http://localhost:8000/api/
- **–ê–¥–º–∏–Ω–∫–∞**: http://localhost:8000/admin/ (admin@foodgram.ru / admin123)
- **API Docs**: `/docs/redoc.html` (ReDoc)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ API
pytest apps/api/tests.py -v

# –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
pytest --cov=apps
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

- **OpenAPI Schema**: `docs/openapi-schema.yml`
- **ReDoc UI**: `docs/redoc.html`
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: `docs/architecture.md`
- **Best Practices**: `docs/best_practices.md`

## üîÑ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**‚úÖ –≠—Ç–∞–ø—ã 1-4 –ó–ê–í–ï–†–®–ï–ù–´**
- –ì–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º React
- –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- –ì–æ—Ç–æ–≤ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É: –¥–µ–ø–ª–æ–π –∏ CI/CD

–í—Å–µ API endpoints —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ OpenAPI –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! 